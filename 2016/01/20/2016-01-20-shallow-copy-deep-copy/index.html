<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=""><meta name="keyword" content=""><link rel="shortcut icon" href="/img/favicon.ico"><title>얕은 복사(shallow copy) vs 깊은 복사(deep copy) - 보노의블로그 | Bono&#39;s Blog</title><link rel="canonical" href="http://blueshw.githup.io/2016/01/20/2016-01-20-shallow-copy-deep-copy/"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/hux-blog.css"><link rel="stylesheet" href="/css/highlight.css"><link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]--><script></script></head><body ontouchstart=""><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class="container-fluid"><div class="navbar-header page-scroll"><button type="button" class="navbar-toggle"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="/">보노의 블로그</a></div><div id="huxblog_navbar"><div class="navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/">Home</a></li><li><a href="/about/">About</a></li><li><a href="/archives/">Archives</a></li><li><a href="/tags/">Tags</a></li></ul></div></div></div></nav><script>function handleMagic(e){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic)</script><style type="text/css">header.intro-header{background-image:url(/img/home-bg.jpg)}</style><header class="intro-header"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><div class="tags"><a class="tag" href="/tags/#python" title="python">python</a> <a class="tag" href="/tags/#deep copy" title="deep copy">deep copy</a></div><h1>얕은 복사(shallow copy) vs 깊은 복사(deep copy)</h1><h2 class="subheading"></h2><span class="meta">Posted by bono on 2016-01-20</span></div></div></div></div></header><article><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container"><p>이번에는 객체의 복사에 대해서 알아보려고 합니다. 객체의 복사는 크게 얉은 복사(shallow copy)와 깊은 복사(deep copy)로 나뉩니다. 얼핏 들으면 단어 자체의 의미가 모호하게 느껴질 수도 있습니다만, 사실은 크게 어려운 개념은 아닙니다. 하지만 주의해서 사용하지 않으면 크나큰 문제를 야기할 수도 있습니다. 이미 잘 알고 있다 하더라도 확실히 짚고 넘어 간다는 생각으로 다시한번 정리해 보시면 좋을것 같네요</p><h3 id="1-단순-객체복제"><a href="#1-단순-객체복제" class="headerlink" title="1. 단순 객체복제"></a>1. 단순 객체복제</h3><p>변수만 복사하다 보니 바라보는 객체는 당연히 동일하겠죠.<br>즉, 두개의 변수 중 하나만 변경되어도 나머지 하나도 동일하게 수정되는 현상이 발생하게 됩니다.</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</div><div class="line">b = a     # shallow copy</div><div class="line">print(b)    # [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</div><div class="line">b[<span class="number">2</span>] = <span class="number">100</span>   # b의 item 변경</div><div class="line">print(b)    # [<span class="number">1</span>, <span class="number">2</span>, <span class="number">100</span>, <span class="number">4</span>]</div><div class="line">print(a)    # [<span class="number">1</span>, <span class="number">2</span>, <span class="number">100</span>, <span class="number">4</span>], a의 item도 수정됨!!</div></pre></td></tr></table></figure><p>리스트를 만들어(파이썬에서 대괄호’[ ]’는 list) 1에서 4까지 네개의 숫자를 넣고 a에 할당했습니다.<br>그러면 a는 리스트 객체의 주소를 바라보는 변수가 되는 것이죠.<br>그런뒤 a를 b에 할당해 주었습니다. 그러면 b는 a와 같은 객체의 주소를 바라보게 됩니다.</p><p>문제는 a 또는 b를 수정하게 되면 문제가 발생합니다.<br>위에서 처럼 b의 세번째(2) 값을 3에서 100으로 바꿔주게 되면, 당연히 b는 [1, 2, 100, 4] 처럼 출력됩니다.<br>그런데 변경되지 않을 거라고 예상했던 a 또한 b와 같이 [1, 2, 100, 4] 로 수정되어버렸습니다.<br>이는 a와 b가 동일한 객체를 참조하기 때문에 발생하는 문제입니다.</p><p>한가지 주의할 점은 위의 경우처럼 복사된 참조 변수를 수정했을때,<br>처음에 할당한 참조 변수의 값 역시 똑같이 수정되는 것은 리스트와 같은 변경가능(mutable) 객체일 때만 해당한다는 것입니다.<br>숫자나 문자열과 같은 불변의(immutable) 객체일때는 위의 경우가 해당되지 않습니다.</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">10</span></div><div class="line"><span class="keyword">b </span>= a     </div><div class="line">print(<span class="keyword">b) </span>   <span class="comment"># 10 출력력</span></div><div class="line"><span class="keyword">b </span>= <span class="string">"abc"</span>  </div><div class="line">print(<span class="keyword">b) </span>   <span class="comment"># abc 출력</span></div><div class="line">print(a)    <span class="comment"># 10 출력</span></div></pre></td></tr></table></figure><p>위와 같은 결과가 나타나는 이유는, 불변의 객체이기 때문입니다.<br>말장난 하는것 같아 보이지만, 불변의 객체란 값이 바뀌지 않는 객체를 뜻하죠.<br>그렇기 때문에 참조변수를 수정한다는 것은 같은 주소의 값(value)이 바뀌는 것이 아니라 그 변수에 새로운 객체가 할당되는 것을 뜻합니다.</p><h3 id="2-얉은-복사-shallow-copy"><a href="#2-얉은-복사-shallow-copy" class="headerlink" title="2. 얉은 복사(shallow copy)"></a>2. 얉은 복사(shallow copy)</h3><p>얉은 복사의 경우는 어떨까요? 단순 복사와 어떤 차이가 있을까요?<br>단순 복제와 얉은 복사의 차이점은 복합객체(리스트)는 별도로 생성하지만 그 안에 들어가는 내용은 원래와 같은 객체 객체라는 점입니다.<br>예제로 살펴보면 아래와 같습니다.</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">import copy</div><div class="line"></div><div class="line">a = [<span class="number">1</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]]</div><div class="line">b = copy.copy(a)    # shallow copy 발생     </div><div class="line">print(b)    # [<span class="number">1</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]] 출력</div><div class="line">b[<span class="number">0</span>] = <span class="number">100</span>  </div><div class="line">print(b)    # [<span class="number">100</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]] 출력, </div><div class="line">print(a)    # [<span class="number">1</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]] 출력, shallow copy 가 발생해 복사된 리스트는 별도의 객체이므로 item을 수정하면 복사본만 수정된다. (immutable 객체의 경우)</div><div class="line"></div><div class="line">c = copy.copy(a)</div><div class="line">c[<span class="number">1</span>].append(<span class="number">4</span>)    # 리스트의 두번째 item(내부리스트)에 <span class="number">4</span>를 추가</div><div class="line">print(c)    # [<span class="number">1</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]] 출력</div><div class="line">print(a)    # [<span class="number">1</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]] 출력, a가 c와 똑같이 수정된 이유는 리스트의 item 내부의 객체는 동일한 객체이므로 mutable한 리스트를 수정할때는 둘다 값이 변경됨</div></pre></td></tr></table></figure><p>주석에서 잘 설명하고 있지만, 리스트 내에 리스트가 있는 경우에 얉은 복사(b = copy.copy(a))가 이뤄지더라도 리스트 내의 내부 리스트까지 별도의 객체로 복사가 되는것은 아닙니다.</p><p>위의 예제에서 b에서 첫번째 요소(숫자)를 변경하였을때 a가 변경되지 않은 것은 그 요소가 immutable 하기 때문입니다.<br>immutable 하다는 것은, 요소가 수정되는 것이 아니라 그저 다른 값으로 대체된다고 볼 수 있죠.<br>그렇기 때문에 b에서 변경된 요소가 a에는 반영되어 있지 않은 것이죠.(두 리스트는 다른 객체이므로..)</p><p>그러나 c의 경우는 좀 다릅니다.<br>a를 복사하여(c = copy.copy(a)) c를 만듭니다.<br>그리고 c의 두번째 요소(리스트)에 새로운 값을 추가합니다.<br>출력해보면 a와 b의 경우처럼 c에 값을 수정했을때 a는 수정되지 않을거라 기대되지만, 실제는 그렇지 않습니다.<br>c의 내부리스트를 수정하게 되면 a의 내부리스트 또한 바뀌게 되는데요.<br>그 이유는 a와 c의 내부리스트는 같은 객체를 참조하기 때문입니다.<br>b의 경우에도 같은 객체라 말할 수도 있지만, 이 둘의 중요한 차이는 그 객체가 mutable하냐 immutable하냐의 차이입니다.<br>mutable 한 경우에는 값이 수정될수 있지만, immutable 한 경우에는 값이 수정되는 것이 아니라 아예 새로운 객체로 변경되는 것이죠.<br>그래서 위와 같은 차이가 나타나게 되는 것입니다.</p><h3 id="3-깊은-복사-deep-copy"><a href="#3-깊은-복사-deep-copy" class="headerlink" title="3. 깊은 복사(deep copy)"></a>3. 깊은 복사(deep copy)</h3><p>mutable한 내부객체(내부리스트)의 문제를 해결하기 위해서는 얉은 복사가 아닌 깊은 복사(deep copy)를 해야 합니다.</p><p>얉은 복사가 복합객체(리스트)만 복사되고 그 안의 내용은 동일한 객체를 참조한다면,<br>깊은 복사의 경우에는 복합객체를 새롭게 생성하고 그 안의 내용까지 재귀적으로 새롭게 생성하게 됩니다.</p><p>그래서 깊은 복사를 하게 되면, 처음에 만들었던 객체와 복사된 객체가 전혀 달라지기 때문에 어느 한쪽을 수정한다고 해서 다른 한쪽이 영향 받는 일은 없게되겠죠.</p><p>파이썬에서는 copy모듈의 deepcopy()라는 메서드를 통해 깊은 복사를 손쉽게 구현할 수 있습니다.</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">import copy</div><div class="line"></div><div class="line">a = [<span class="number">1</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]]</div><div class="line">b = copy.deepcopy(a)    # deep copy 실행     </div><div class="line">print(b)    # [<span class="number">1</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]] 출력</div><div class="line">b[<span class="number">0</span>] = <span class="number">100</span></div><div class="line">b[<span class="number">1</span>].append(<span class="number">4</span>)  </div><div class="line">print(b)    # [<span class="number">100</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]] 출력</div><div class="line">print(a)    # [<span class="number">1</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]] 출력</div></pre></td></tr></table></figure><h3 id="정리해보면"><a href="#정리해보면" class="headerlink" title="정리해보면,"></a>정리해보면,</h3><blockquote><ol><li>단순복제는 완전히 동일한 객체,</li><li>얉은복사(shallow copy)는 복합객체(껍데기)만 복사, 그 내용은 동일한 객체</li><li>깊은복사(deep copy)는 복합객체 복사 + 그 내용도 재귀적으로 복사</li></ol></blockquote><hr><ul class="pager"><li class="previous"><a href="/2016/01/22/2016-01-22-python-conditional-ternary-operator/" data-toggle="tooltip" data-placement="top" title="파이썬 3항 연산자 비교">&larr; Previous Post</a></li><li class="next"><a href="/2016/01/16/2016-01-16-django-migration/" data-toggle="tooltip" data-placement="top" title="[django] 장고 트랜잭션 활용">Next Post &rarr;</a></li></ul><div class="comment"><div id="disqus_thread" class="disqus-thread"></div></div></div><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 sidebar-container"><section><h5><a href="/tags/">FEATURED TAGS</a></h5><div class="tags"><a class="tag" href="/tags/#python" title="python">python</a> <a class="tag" href="/tags/#deep copy" title="deep copy">deep copy</a></div></section></div></div></div></article><script type="text/javascript">var disqus_shortname="bonogithub",disqus_identifier="http://blueshw.githup.io/2016/01/20/2016-01-20-shallow-copy-deep-copy/",disqus_url="http://blueshw.githup.io/2016/01/20/2016-01-20-shallow-copy-deep-copy/";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><script>function async(e,n){var t=document,a="script",r=t.createElement(a),c=t.getElementsByTagName(a)[0];r.src=e,n&&r.addEventListener("load",function(e){n(null,e)},!1),c.parentNode.insertBefore(r,c)}</script><script>async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){anchors.options={visible:"always",placement:"right",icon:"#"},anchors.add().remove(".intro-header h1").remove(".subheading").remove(".sidebar-container h5")})</script><style>@media all and (min-width:800px){.anchorjs-link{position:absolute;left:-.75em;font-size:1.1em;margin-top:-.1em}}</style><footer><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a target="_blank" href="https://www.facebook.com/blueshw"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" href="https://github.com/blueshw"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; 보노의 블로그 2017<br>Theme by <a href="http://huangxuan.me">Hux</a> <span style="display:inline-block;margin:0 5px"><i class="fa fa-heart"></i> </span>Ported by <a href="http://blog.kaijun.rocks">Kaijun</a> |<iframe style="margin-left:2px;margin-bottom:-5px" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=kaijun&repo=hexo-theme-huxblog&type=star&count=true"></iframe></p></div></div></div></footer><script src="/js/jquery.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/hux-blog.min.js"></script><script>function async(e,n){var t=document,a="script",r=t.createElement(a),c=t.getElementsByTagName(a)[0];r.src=e,n&&r.addEventListener("load",function(e){n(null,e)},!1),c.parentNode.insertBefore(r,c)}</script><script>0!==$("#tag_cloud").length&&async("http://blueshw.githup.io/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js",function(){var c=document.querySelector("nav");c&&FastClick.attach(c)})</script><script>var _gaId="UA-50048807-2",_gaDomain="blueshw.github.io";!function(e,a,n,t,g,o,c){e.GoogleAnalyticsObject=g,e[g]=e[g]||function(){(e[g].q=e[g].q||[]).push(arguments)},e[g].l=1*new Date,o=a.createElement(n),c=a.getElementsByTagName(n)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(o,c)}(window,document,"script",0,"ga"),ga("create",_gaId,_gaDomain),ga("send","pageview")</script><img src="http://blueshw.githup.io/img/icon_wechat.png" width="0" height="0"></body></html>