<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=""><meta name="keyword" content=""><link rel="shortcut icon" href="/img/favicon.ico"><title>[python] set에 관한 두가지 사실 - 보노의블로그 | Bono&#39;s Blog</title><link rel="canonical" href="http://blueshw.githup.io/2016/02/28/python-about-set/"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/hux-blog.css"><link rel="stylesheet" href="/css/highlight.css"><link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]--><script></script></head><body ontouchstart=""><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class="container-fluid"><div class="navbar-header page-scroll"><button type="button" class="navbar-toggle"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="/">보노의 블로그</a></div><div id="huxblog_navbar"><div class="navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/">Home</a></li><li><a href="/about/">About</a></li><li><a href="/archives/">Archives</a></li><li><a href="/tags/">Tags</a></li></ul></div></div></div></nav><script>function handleMagic(e){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic)</script><style type="text/css">header.intro-header{background-image:url(/img/home-bg.jpg)}</style><header class="intro-header"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><div class="tags"><a class="tag" href="/tags/#python" title="python">python</a> <a class="tag" href="/tags/#set" title="set">set</a></div><h1>[python] set에 관한 두가지 사실</h1><h2 class="subheading"></h2><span class="meta">Posted by bono on 2016-02-28</span></div></div></div></div></header><article><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container"><p>중복이 제거된 자료구조를 만들어야 할 일이 있어 set을 쓰게 되었는데요.<br>set으로 만들어진 자료를 바탕으로 루프를 돌며 set안의 item들을 처리하는 작업이었습니다.<br>item이 너무 많아지게 되면, 메모리 등의 성능 이슈가 발생할 것을 대비하여 20만개씩 잘라서 분절해야 했는데요.<br>이 때 첫번째 문제가 발생했습니다. python에서 set은 분절 할 수 없다는 것입니다.<br>리스트의 경우에는 아래와 같이 분절이 가능합니다만, set은 리스트 처럼 분절이 불가합니다.</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="attr">temp_list</span> = [<span class="string">'a, '</span>b<span class="string">', '</span>c<span class="string">', '</span>d<span class="string">', '</span>e<span class="string">', '</span>f<span class="string">']</span></div><div class="line">temp_list[:3]      </div><div class="line"></div><div class="line"># ['a, <span class="string">'b'</span>, <span class="string">'c'</span>] 출력</div></pre></td></tr></table></figure><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">temp_set = &#123;<span class="symbol">'a</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>&#125;</div><div class="line">temp_set[:<span class="number">3</span>]</div><div class="line"></div><div class="line"># 아래의 에러 발생</div><div class="line"># Traceback (most recent call last):</div><div class="line"># File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line"># TypeError: <span class="symbol">'set</span>' object <span class="keyword">is</span> <span class="keyword">not</span> subscriptable</div></pre></td></tr></table></figure><p>루프를 돌면서 처리할 수도 있겠지만, 그것보다는 왜 set이 분절이 안될까라는 고민에 빠져 도대체 set은 어떻게 만들어진건가 궁금해지더라구요.<br>구글링을 하다 파이썬 공식 문서에(2.7 버전, 파이썬 3보다 설명이 괜찮더라구요) set은 아래와 같은 내용을 찾았습니다.</p><blockquote><p>The sets module provides classes for constructing and manipulating unordered collections of unique elements. Common uses include membership testing, removing duplicates from a sequence, and computing standard math operations on sets such as intersection, union, difference, and symmetric difference.</p><p>Like other collections, sets support x in set, len(set), and for x in set. Being an unordered collection, sets do not record element position or order of insertion. Accordingly, sets do not support indexing, slicing, or other sequence-like behavior.</p><p>……</p><p>The set classes are implemented using dictionaries. Accordingly, the requirements for set elements are the same as those for dictionary keys; namely, that the element defines both <strong>eq</strong>() and <strong>hash</strong>(). As a result, sets cannot contain mutable elements such as lists or dictionaries</p></blockquote><p>대략적인 내용을 살펴보면(발번역 및 의역),</p><blockquote><p>set은 순서가 없는 중복이 불가능한 collection 자료형이다. 주로 item 테스트, 중복제거 등에 사용되고 교집합, 합집합, 차집합 등을 수학적인 계산이 가능하다. 다른 collection 자료형 처럼 item 검사, 길이, 루프가 가능하다. set은 삽입된 item의 위치를 저장하지 않기 때문에 item 간의 순서가 없다. 따라서 indexing이 불가능하고, 자르기가 안되고, 그외의 sequential한 작업이 불가하다. set은 dictionary를 구현한 클래스인데, dictionary의 key가 set의 item이 된다. 그렇기 때문에 set은 dictionary나 list처럼 중복되는 요소를 담을 수 없다.</p></blockquote><p>정도가 되겠네요. 위의 번역을 토대로 set이 분절이 안되는 이유는 item을 저장할때 순서값을 저장하지 않기 때문이라 할 수 있겠네요.<br>순서가 없으니 어디서부터 어디까지라는 것을 정할 수 없을 것이고, 그렇기 때문에 분절이 불가능하다 할 수 있겠습니다.</p><p>그리고 두 번째 문제가 있었는데, set의 루핑 속도에 대한 것이었습니다.<br>파이썬에서 set역시 list와 같이 iterable한 자료구조이긴 하지만, list에 비해서 iteration 성능은 떨어지는 것으로 익히 알려져 있습니다.<br>대신 hash 기반으로 만들어지기 때문에 검색 속도는 list에 비해 훨씬 뛰어나죠.</p><p>우선 진짜 set이 list에 비해 iteration 성능이 떨어지는지 확인해 보았습니다.</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">from timeit <span class="built_in">import</span> timeit</div><div class="line"></div><div class="line">def iter(iterable):</div><div class="line">    for i <span class="keyword">in</span> iterable:</div><div class="line">        pass</div><div class="line"></div><div class="line">timeit(<span class="string">"iter(iterable)"</span>, <span class="attr">number=1000,</span> <span class="attr">setup="from</span> __main__ <span class="built_in">import</span> iter; <span class="attr">iterable=set(range(1000000))")</span></div><div class="line"><span class="comment"># 결과 : 14.660961047000455 (단위: 초)</span></div><div class="line"></div><div class="line">timeit(<span class="string">"iter(iterable)"</span>, <span class="attr">number=1000,</span> <span class="attr">setup="from</span> __main__ <span class="built_in">import</span> iter; <span class="attr">iterable=list(range(1000000))")</span></div><div class="line"><span class="comment"># 결과 : 11.929272602999845 (단위: 초)</span></div></pre></td></tr></table></figure><p>1,000,000(백만, 0~999,999) 까지의 숫자를 담은 set을 1,000번 반복한 결과 14.66초 정도가 걸렸습니다.<br>반면에 같은 조건으로 list를 1,000번 반복한 결과 11.93초 정도가 걸렸네요.<br>대략 3초 정도가 차이납니다.<br>사실 1,000,000을 1,000번 반복하여 총 1,000,000,000(10억)번 루프를 돌아야만 3초 정도(14-11)가 차이가 난것이지,<br>현업에서 사용하는 정도의 크기로 비교해보면 그렇게 큰 차이가 나지는 않는것 같네요.<br>속도차이가 크게 나지 않기 때문에 특별한 이유가 없다면 set으로 루프를 돌려도 무방할 것 같습니다.</p><p>글을 쓰고 나니 알맹이는 없고 횡설수설한 느낌입니다.<br>어찌되었든 위의 두가지(set은 slice를 못하는 것, list보다 iteration 성능이 떨어지는것) 사실로 set에 대한 궁금증이 완전히 사라진 것은 아닙니다.<br>set이라는 자료구조가 머리속에 그림으로 그려져서 더하고 삭제하거나 탐색할때, 또는 set을 list로 바꿀 때와 같은 경우를 한번에 떠올릴 수 있으면 참 좋겠습니다만, 아직까지는 더 노력이 필요한 것 같습니다.<br>너무 많은 내용을 한번에 다루면 포스팅하는 저나 읽는 사람들 모두 피곤할테니 일단은 여기서 글을 마무리 하는게 좋을것 같네요.</p><hr><ul class="pager"><li class="previous"><a href="/2016/03/01/django-virtual-env-setting-for-mac/" data-toggle="tooltip" data-placement="top" title="[django] 장고(django) 개발을 위한 파이썬(python) 가상환경 설정(Mac 환경)">&larr; Previous Post</a></li><li class="next"><a href="/2016/02/24/python-import-by-class-name/" data-toggle="tooltip" data-placement="top" title="[python] 클래스 이름을 사용한 동적 모듈 import">Next Post &rarr;</a></li></ul><div class="comment"><div id="disqus_thread" class="disqus-thread"></div></div></div><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 sidebar-container"><section><h5><a href="/tags/">FEATURED TAGS</a></h5><div class="tags"><a class="tag" href="/tags/#python" title="python">python</a> <a class="tag" href="/tags/#set" title="set">set</a></div></section></div></div></div></article><script type="text/javascript">var disqus_shortname="bonogithub",disqus_identifier="http://blueshw.githup.io/2016/02/28/python-about-set/",disqus_url="http://blueshw.githup.io/2016/02/28/python-about-set/";!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}()</script><script>function async(e,n){var t=document,a="script",r=t.createElement(a),c=t.getElementsByTagName(a)[0];r.src=e,n&&r.addEventListener("load",function(e){n(null,e)},!1),c.parentNode.insertBefore(r,c)}</script><script>async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){anchors.options={visible:"always",placement:"right",icon:"#"},anchors.add().remove(".intro-header h1").remove(".subheading").remove(".sidebar-container h5")})</script><style>@media all and (min-width:800px){.anchorjs-link{position:absolute;left:-.75em;font-size:1.1em;margin-top:-.1em}}</style><footer><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a target="_blank" href="https://www.facebook.com/blueshw"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" href="https://github.com/blueshw"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; 보노의 블로그 2017<br>Theme by <a href="http://huangxuan.me">Hux</a> <span style="display:inline-block;margin:0 5px"><i class="fa fa-heart"></i> </span>Ported by <a href="http://blog.kaijun.rocks">Kaijun</a> |<iframe style="margin-left:2px;margin-bottom:-5px" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=kaijun&repo=hexo-theme-huxblog&type=star&count=true"></iframe></p></div></div></div></footer><script src="/js/jquery.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/hux-blog.min.js"></script><script>function async(e,n){var t=document,a="script",r=t.createElement(a),c=t.getElementsByTagName(a)[0];r.src=e,n&&r.addEventListener("load",function(e){n(null,e)},!1),c.parentNode.insertBefore(r,c)}</script><script>0!==$("#tag_cloud").length&&async("http://blueshw.githup.io/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js",function(){var c=document.querySelector("nav");c&&FastClick.attach(c)})</script><script>var _gaId="UA-50048807-2",_gaDomain="blueshw.github.io";!function(e,a,n,t,g,o,c){e.GoogleAnalyticsObject=g,e[g]=e[g]||function(){(e[g].q=e[g].q||[]).push(arguments)},e[g].l=1*new Date,o=a.createElement(n),c=a.getElementsByTagName(n)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(o,c)}(window,document,"script",0,"ga"),ga("create",_gaId,_gaDomain),ga("send","pageview")</script><img src="http://blueshw.githup.io/img/icon_wechat.png" width="0" height="0"></body></html>