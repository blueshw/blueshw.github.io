{"data":{"site":{"siteMetadata":{"title":"bono's blog","author":"bono"}},"markdownRemark":{"id":"0f8ddf6a-df65-509c-b0a3-d6607739c528","excerpt":"리액트를 개발하다보면 이런 코드를 본적 있을것입니다. this(아마도 react 클래스 객체)에 속한 어떤 메서드를 다시 this 에 bind…","html":"<p>리액트를 개발하다보면 이런 코드를 본적 있을것입니다.</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>this.someFunction.bind(this);</span></span></div></pre></div>\n<p>this(아마도 react 클래스 객체)에 속한 어떤 메서드를 다시 this 에 bind 한다라?? 굳이 왜 이런짓을 해야하는지 의문이 들만합니다.</p>\n<p>리액트에서 이러한 코드가 빈번하게 작성되는 이유를 알기 위해서 우선 <code>bind()</code>가 무슨 역할을 하는지부터 알아보겠습니다.</p>\n<h4>bind()</h4>\n<p>bind 함수는 바인드하는 함수에서 사용하는 <code>this</code>의 대상을 지정해주는 역할을 합니다. 잘 사용하지 않아서 그렇지 그다지 어려운 개념은 아닙니다.</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>const&nbsp;objA&nbsp;=&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;name:&nbsp;&quot;a&quot;,</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;aFunc:&nbsp;function()&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(this.name);</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>const&nbsp;objB&nbsp;=&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;name:&nbsp;&quot;b&quot;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>objA.aFunc();&nbsp;//&nbsp;(1)</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>//&nbsp;a</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>objA.aFunc.bind(objB);&nbsp;//&nbsp;(2)</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>const&nbsp;foo&nbsp;=&nbsp;objA.aFunc.bind(objB);&nbsp;//&nbsp;(3)</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>foo();&nbsp;(4)</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>//&nbsp;b</span></span></div></pre></div>\n<p><code>objA</code>와 <code>objB</code>라는 객체가 있습니다. objA 객체는 <code>name</code>이라는 값과 <code>aFunc</code>라는 함수를 속성으로 가지고 있습니다. 반면 objB 객체는 <code>name</code>이라는 값만 가지고 있죠.</p>\n<p>(1) objA 의 aFunc 함수를 실행하면 예상대로 <code>a</code>가 출력됩니다.</p>\n<p>(2) objA 객체의 aFunc 함수에서 bind(objB)를 호출합니다. 함수가 호출되었지만, 아무것도 출력되지 않죠. 다만, 원본 aFunc 함수와 동일한 기능을 하는 바인딩된 새로운 함수가 만들어집니다. 이때, bind 메서드에 전해진 인자는 복사된 바인딩 함수의 this 로 전달됩니다. 즉, aFunc 함수내의 <code>this</code>가 <code>objB</code>가 되는 것이죠. 이게 <code>bind()함수</code>가 하는 일의 전부입니다.</p>\n<p>(3) 바인드 함수를 변수에 할당합니다.</p>\n<p>(4) 실행하면 <code>b</code>가 출력됩니다.</p>\n<h3>React 에서의 bind()</h3>\n<p>처음 잠깐 살펴보았지만, 리액트에서 bind()함수는 다음과 같이 사용됩니다.</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>import&nbsp;React&nbsp;from&nbsp;&#39;react&#39;;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>class&nbsp;BindTest&nbsp;extends&nbsp;React.Component&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;handleClick()&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(this);</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;render()&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&lt;button&nbsp;type=&quot;button&quot;&nbsp;onClick={this.handleClick.bind(this)}&gt;Goodbye&nbsp;bind&lt;/button&gt;;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>export&nbsp;default&nbsp;BindTest;</span></span></div></pre></div>\n<p>간단한 React 컴포넌트입니다. 버튼을 클릭하면 <code>this</code>에 해당하는 정보가 출력됩니다.</p>\n<p><img src=\"./bind.png\" alt=\"bind\"></p>\n<p>버튼 태그의 onClick 속성을 보면 bind() 함수가 사용되고 있는걸 알수 있습니다. 근데 좀 이상합니다. this 의 handleClick 함수에다가 this 객체를 바인드시켰습니다. 같은 this 인데 굳이 또 바인드해주는 이유가 뭘까요? bind 함수를 빼보겠습니다.</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>import&nbsp;React&nbsp;from&nbsp;&#39;react&#39;;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>class&nbsp;WithoutBindTest&nbsp;extends&nbsp;React.Component&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;handleClick()&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(this);</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;render()&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&lt;button&nbsp;type=&quot;button&quot;&nbsp;onClick={this.handleClick}&gt;Goodbye&nbsp;bind&nbsp;without&nbsp;this&lt;/button&gt;;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>export&nbsp;default&nbsp;WithoutBindTest;</span></span></div></pre></div>\n<p>어떤 결과가 나올까요?</p>\n<p><img src=\"./withoutbind.png\" alt=\"withoutbind\"></p>\n<p><code>null</code>이 출력되었습니다. 왜 null 이 출력되었을까요?</p>\n<p>이 내용을 이해하려면 자바스크립트에서의 <code>this</code>에 대해 어느정도 알고 있어야 합니다.</p>\n<h3>this</h3>\n<p>객체지향 언어에서의 일반적인 this 의 의미(현재 객체를 지칭)와는 달리 자바스크립트의 this 는 실행시의 context 를 말하죠. 아래 예제를 보면,</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>const&nbsp;thisTest&nbsp;=&nbsp;function()&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;console.log(this.value);</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>thisTest.value&nbsp;=&nbsp;&quot;I&nbsp;am&nbsp;this&quot;;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>thisTest();</span></span></div></pre></div>\n<p><code>\"I am this\"</code>가 나올거라는 예상과는 달리 <code>undefined</code>가 출력됩니다. 왜냐하면 <code>thisTest()</code>가 출력될 때의 context 가 전역객체이기 때문입니다. thisTest.value 는 thisTest 에 속성인데 전역객체에서 value 를 찾으려고 하니 undefined 가 나올수 밖에 없습니다(window 객체가 아니라 undefined 인 이유는 React 가 기본적으로 strict 모드에서 실행되기 때문입니다).</p>\n<p>\"I am this\"를 출력하려면, this 에 해당하는 객체의 메서드를 호출하면 this.value 값을 가져올 수 있습니다. 아래 예제를 보면,</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>const&nbsp;thisTest&nbsp;=&nbsp;function()&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;console.log(this.value);</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>thisTest.value&nbsp;=&nbsp;&quot;I&nbsp;am&nbsp;this&quot;;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>thisTest.func&nbsp;=&nbsp;function(){</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;console.log(this.value);</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>thisTest.func();</span></span></div></pre></div>\n<p><code>thisTest.func</code> 함수를 만들어서 그안에서 <code>this.value</code>를 출력합니다. thisTest 객체의 func() 메서드를 호출하면 이 때는 <code>this</code>가 thisTest 가 되기 때문에 정상적으로 this.value 를 가져와 \"I am this\"를 출력합니다.</p>\n<p>이제, 리액트로 다시 돌아가보죠.</p>\n<h3>React 에서의 this</h3>\n<p>WithoutBindTest 클래스의 render() 함수를 다시 살펴보겠습니다.</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>render()&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&lt;button&nbsp;type=&quot;button&quot;&nbsp;onClick={this.handleClick}&gt;Goodbye&nbsp;bind&nbsp;without&nbsp;this&lt;/button&gt;;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>}</span></span></div></pre></div>\n<p>컴포넌트의 render()함수가 실행되면 DOM 이 그려질것입니다. 이때 this 는 WithoutBindTest 객체를 가리키는것이 맞습니다. 하지만 handleClick()함수가 호출될때의 this 는 WithoutBindTest 가 아닌 전역객체(Window)를 의미합니다. 왜냐하면 this 라는 값은 호출하는 문맥(context)에의해 좌우되는데 클릭이 실행되는 문맥이 바로 전역(window)객체이기 때문이죠.</p>\n<h3>Arrow Function</h3>\n<p>click, change 등의 이벤트 리스너를 붙여줄때마다 <code>bind()</code>함수를 작성하는건 귀찮은 일입니다. ES6 의 <code>화살표함수</code>를 사용하면 이 문제를 간단히 해결할 수 있습니다. BindTest 를 화살표 함수를 이용해 새로 작성해보았습니다.</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>import&nbsp;React&nbsp;from&nbsp;&#39;react&#39;;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>class&nbsp;BindTest&nbsp;extends&nbsp;React.Component&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;handleClick&nbsp;=&nbsp;()&nbsp;=&gt;&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(this);</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;render()&nbsp;{</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&lt;button&nbsp;type=&quot;button&quot;&nbsp;onClick={this.handleClick}&gt;Goodbye&nbsp;bind&lt;/button&gt;;</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>}</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>export&nbsp;default&nbsp;BindTest;</span></span></div></pre></div>\n<p>이제는 this 가 무엇인지 걱정할 필요가 없습니다. 화살표 함수의 this 는 외부함수(부모함수)의 this 를 상속받기 때문에 this 는 항상 일정합니다. 위 예제의 경우에는 BindTest 클래스(사실 함수입니다)가 되겠죠.</p>\n<h3>결론</h3>\n<blockquote>\n<p>bind()함수는 전달된 인자를 this 로 보내는 바인딩 함수를 만듭니다.\nthis 는 다른 언어와 달리 실행 문맥(context)에 따라 변합니다.\nReact 에서 이벤트 핸들러 함수를 바인드할때 화살표 함수를 사용합니다.</p>\n</blockquote>","frontmatter":{"title":"[ES6, react] 리액트에서 화살표 함수(arrow function)는 선택이 아닌 필수","date":"July 01, 2017"}}},"pageContext":{"slug":"/2017/07/01/arrow-function/","previous":{"fields":{"slug":"/2017/06/26/presentaional-component-container-component/"},"frontmatter":{"title":"[번역] 프레젠테이션 컴포넌트와 컨테이너 컴포넌트"}},"next":{"fields":{"slug":"/2018/01/28/tasks-microtasks-queues-and-schedules/"},"frontmatter":{"title":"[번역] Tasks, microtasks, queues and schedules"}}}}